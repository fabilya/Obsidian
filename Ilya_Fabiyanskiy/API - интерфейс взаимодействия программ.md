**API** (от англ. **A**pplication **P**rogramming **I**nterface, «программный интерфейс приложения») — это интерфейс для обмена данными.

Программу, которая обращается к API с запросом, называют «клиент» (или client, если по-английски). Клиентом может быть код на сервере, мобильное приложение, программа для тестирования или даже обычный веб-браузер.

![[Image (4).png]]

[[JSON]]
[[XML]] - (_e**X**tensible **M**arkup **L**anguage_, «расширяемый язык разметки») тоже весьма популярен и широко применяется в разработке. Внешне этот язык чем-то похож на HTML, и это неслучайно: язык разметки веб-страниц — прямой потомок XML.

Одно из основных отличий HTML от XML в том, что названия тегов в XML не стандартизированы, их можно называть по собственному желанию. Да и предназначение у этих языков разное: теги HTML служат для отображения информации в браузере, а XML-теги просто структурируют передаваемую информацию.

Синтаксис похож на HTML: теги пишутся в треугольных скобках, есть открывающий тег и (в большинстве случаев) к нему в пару должен быть закрывающий.

Проверить валидность XML можно с помощью любого онлайн-валидатора, например через валидатор на [codebeautify.org](https://codebeautify.org/xmlvalidator).

Существует целый класс технологий, позволяющих программам удалённо вызывать функции или процедуры. Эти технологии называют **RPC** (англ. _Remote Procedure Call_, «удаленный вызов процедур»).

Рассмотрим самые известные технологии этого класса, которые чаще всего применяются для создания API.

## Протокол [[SOAP]]: данные в конверте

SOAP (англ. _**S**imple **O**bject **A**ccess **P**rotocol_, «протокол доступа к простым объектам») — это `протокол`, который применяется для удаленного вызова процедур, обмена произвольными сообщениями в формате XML и для организации API-сервисов. Протокол SOAP был разработан для Microsoft, первый релиз появился в 1998 году.

Сообщения, которые курсируют между клиентом и сервером — это XML-файлы, составленные по определённому стандарту:

-   **Конверт** — это начальный и конечный теги сообщения.
-   **Заголовок** — содержит необязательные атрибуты сообщения.
-   **Тело** — содержит данные, которые сервер передает получателю.
-   **Ошибки** — содержит информацию об ошибках, возникших при обработке сообщения.

![[Image (5).png]]

### Язык [[WSDL]]: инструкция к веб-сервису

Практическая реализация API-сервиса на основе SOAP неразрывно связана с использованием языка **WSDL**.

Язык **WSDL** (англ. _**W**eb **S**ervices **D**escription **L**anguage_, «язык описания веб-сервисов») основан на XML и предназначен для создания машиночитаемых «инструкций», в которых описано, как программа-клиент должна взаимодействовать с сервером.

Для этого в файле с расширением *_.wsdl_ описываются детали взаимодействия клиента и сервера, в том числе — адрес, куда нужно отправлять запросы и структура конверта с запросом и ответом.

WSDL-файл — основа любого сервиса передачи данных, построенного на SOAP: программа-клиент должна знать адрес этого файла, и тогда она будет знать о веб-сервисе всё, что необходимо для работы с ним.

### Применимость SOAP

В настоящее время SOAP чаще всего применяется в сфере финансовых услуг, платежных шлюзов, управления идентификацией — там, где требуется высокая надёжность передачи данных и хорошо [документированный стандарт](https://www.w3.org/TR/soap/), на который можно было бы опираться в юридических документах.

## Архитектура [[REST]]

REST (англ. _**RE**presentational **S**tate **T**ransfer_, «передача состояния представления») — это **архитектурный стиль**, набор принципов взаимодействия компьютерных систем, основанный на методах протокола HTTP. В отличие от SOAP, REST не подкреплен официальным стандартом.

Одно из основных понятий в REST — **ресурс**. Это довольно абстрактное понятие: ресурсом в REST называют «всё, чему можно дать имя в структуре сервиса». Ресурсом может быть что угодно, к чему разработчик REST API считает важным предоставить доступ клиенту.

В качестве примера можно привести цитату из книги "RESTful Web Services" (Leonard Richardson, Sam Ruby, 2007):

> Вот несколько возможных ресурсов:
> 
> -   Версия 1.0.3 компьютерной программы
> -   Последняя версия компьютерной программы
> -   Первая запись в блоге за 24 октября 2006 г.
> -   Дорожная карта Литл-Рока, Арканзас
> -   Некоторая информация о медузах
> -   Каталог ресурсов, относящихся к медузам
> -   Следующее простое число после 1024
> -   Следующие пять простых чисел после 1024
> -   Продажи номера для Q42004
> -   Отношения между двумя знакомыми — Алисой и Бобом
> -   Список открытых ошибок в базе данных ошибок

Вся логика работы REST API базируется именно на ресурсах: к API отправляются запросы, из них клиент получает информацию.

На схеме — воображаемый сервис, который хранит информацию о пицце, цветах, сладостях, книгах и игрушках. Чтобы получить информацию о пицце — нужно сделать запрос к ресурсу `pizzas`, но конфет там не получишь: за конфетами — к ресурсу `sweets`.

![image](https://pictures.s3.yandex.net/resources/inf3_1631639142.png)

Архитектура REST допускает обмен данными в различных форматах, например — в HTML, JSON, XML или даже в формате простого текста, в то время как строгий SOAP допускает только XML.

## Язык запросов [[GraphQL]]: служба одного окна

GraphQL — это не протокол и не архитектура, это **язык запросов к API**.

GraphQL был разработан в компании Facebook в 2012 году, а в 2015 году был выпущен в открытый доступ.

У GraphQL есть три основные особенности:

-   он позволяет клиенту точно указать, какие данные ему нужны;
-   облегчает агрегацию данных из нескольких источников (а REST вернёт данные только одного ресурса);
-   использует систему типов для описания данных.

Вернёмся к воображаемому API с пиццей и другими полезными вещами.

Если API основан на архитектуре **REST** — голодный библиофил-сладкоежка для получения информации о пицце, конфетах и книгах будет вынужден сделать три запроса к трём ресурсам.

В API, основанном на **GraphQL**, можно обойтись одним запросом: «дайте мне информацию о большой "Маргарите", об ирисках и ещё пришлите две главы из "Улисса", пожалуйста!»

![image](https://pictures.s3.yandex.net/resources/inf4_1631639151.png)

## Система удалённого вызова процедур [[gRPC]]: данные в бинарном виде

**gRPC —** это система удалённого вызова процедур, разработанная в Google в 2015 году.

В gRPC сообщения передаются в формате **[protobuf](https://developers.google.com/protocol-buffers)** — `это независимый от платформы и языка` формат передачи данных, разработанный в 2008 году в Google. Основная специфика gRPC в том, что он оперирует данными в бинарном, а не в текстовом, виде.

В gRPC клиентское приложение может напрямую вызывать метод серверного приложения на удалённом компьютере, как если бы это был локальный объект.

Идеальный вариант использования gRPC — это общение между микросервисами и построение коммуникации между мобильным приложением и сервером.

## Самый лучший подход для API

У каждого варианта реализации API-сервиса есть свои особенности. Выбор технологии зависит от требований к проекту. Может быть важен язык программирования или формат, в котором передаются данные; могут быть заявлены требования к быстродействию или объёму передаваемых данных; возможно, есть необходимость опираться на строгий стандарт; даже квалификация разработчиков может быть аргументом в пользу выбора той или иной технологии.

Программисты и архитекторы API взвешивают все плюсы и минусы и выбирают вариант, наиболее подходящий конкретному проекту. Лучшая технология — та, которая лучше всего ляжет на требования к вашему проекту.

Далее в курсе вы будете работать именно с [[REST]] API — это популярная и востребованная на рынке архитектура; изучение REST даст навыки, которые впоследствии помогут разобраться и с другими технологиями.

[[Telegram BOT API]]
